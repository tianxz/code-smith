<?xml version="1.0" encoding="UTF-8" ?>
<!--________________________________________________________________________________
 |                                                                                 |
 |  __/\\\\\\\\\\\________/\\\\\\\\\_____/\\\\\\\\\\\_______/\\\\\\\\\\\___        |
 |   _\/////\\\///______/\\\////////____/\\\/////////\\\___/\\\/////////\\\_       |
 |    _____\/\\\_______/\\\/____________\//\\\______\///___\//\\\______\///__      |
 |     _____\/\\\______/\\\_______________\////\\\___________\////\\\_________     |
 |      _____\/\\\_____\/\\\__________________\////\\\___________\////\\\______    |
 |       _____\/\\\_____\//\\\____________________\////\\\___________\////\\\___   |
 |        _____\/\\\______\///\\\___________/\\\______\//\\\___/\\\______\//\\\__  |
 |         __/\\\\\\\\\\\____\////\\\\\\\\\_\///\\\\\\\\\\\/___\///\\\\\\\\\\\/___ |
 ___________________________________________________________________________________
 |  此代码自动生成，请不要在此文件上做任何修改。如需扩展，请使用组合或继承方式实现。
 |  此代码自动生成，请不要在此文件上做任何修改。如需扩展，请使用组合或继承方式实现。
 |  此代码自动生成，请不要在此文件上做任何修改。如需扩展，请使用组合或继承方式实现。
 ________________________________________________________________________________-->
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.icss.ccp.ios.bridge.dao.FullTableDao">

    <sql id="columnNames">
        `TABLE_CATALOG`, `TABLE_SCHEMA`, `TABLE_NAME`, `TABLE_TYPE`, `ENGINE`, `VERSION`, `ROW_FORMAT`, `TABLE_ROWS`, `AVG_ROW_LENGTH`, `DATA_LENGTH`, `MAX_DATA_LENGTH`, `INDEX_LENGTH`, `DATA_FREE`, `AUTO_INCREMENT`, `CREATE_TIME`, `UPDATE_TIME`, `CHECK_TIME`, `TABLE_COLLATION`, `CHECKSUM`, `CREATE_OPTIONS`, `TABLE_COMMENT`
    </sql>

    <sql id="limit">
        <if test="limit != null">
            LIMIT #{limit.size} OFFSET #{limit.offset}
        </if>
    </sql>

    <sql id="total">
        COUNT(*)
    </sql>

    <sql id="where">
        <where>
            <foreach collection="sqlQueries" item="sqlQuery">
                <if test="sqlQuery.isInclude">
                    <if test="sqlQuery.operator.toString() == 'EQ'">
                        AND ${sqlQuery.sqlName} = #{sqlQuery.value}
                    </if>
                    <if test="sqlQuery.operator.toString() == 'NEQ'">
                        AND ${sqlQuery.sqlName} &lt;&gt; #{sqlQuery.value}
                    </if>
                    <if test="sqlQuery.operator.toString() == 'IN'">
                        AND ${sqlQuery.sqlName} IN
                        <foreach collection="sqlQuery.multiValue" item="value" open="(" close=")" separator=",">
                        #{value}
                        </foreach>
                    </if>
                    <if test="sqlQuery.operator.toString() == 'LIKE'">
                        <bind name="_param1" value="'%' + sqlQuery.value + '%'"/>
                        AND ${sqlQuery.sqlName} LIKE #{_param1}
                    </if>
                    <if test="sqlQuery.operator.toString() == 'AND'">
                        AND (${sqlQuery.sqlName} &amp; #{sqlQuery.value} = #{sqlQuery.value})
                    </if>
                    <if test="sqlQuery.operator.toString() == 'BETWEEN'">
                        <!--X >= value and X <= value-->
                        <foreach collection="sqlQuery.multiValue" item="value" index="index">
                            <if test="index == 0">
                                AND ${sqlQuery.sqlName} &gt;= #{value}
                            </if>
                            <if test="index == 1">
                                AND ${sqlQuery.sqlName} &lt;= #{value}
                            </if>
                        </foreach>
                    </if>
                </if>
            </foreach>
        </where>
    </sql>

    <!-- 查询总行数 -->
    <select id="queryTotal" resultType="long">
        SELECT
        <include refid="total"/>
        FROM `TABLES`
        <include refid="where"/>
    </select>

    <!-- 根据 id 查询  -->
    <select id="queryById" parameterType="long" resultType="com.icss.ccp.ios.bridge.domain.FullTable">
        SELECT <include refid="columnNames"/>
        FROM `TABLES`
        <where>
            UUID = #{uuid}
        </where>
    </select>

    <!-- 使用分页查询所有  -->
    <select id="queryAll" resultType="com.icss.ccp.ios.bridge.domain.FullTable">
        SELECT <include refid="columnNames"/>
        FROM `TABLES`
        <include refid="limit"/>
    </select>

    <!-- 动态查询  -->
    <select id="query" resultType="com.icss.ccp.ios.bridge.domain.FullTable">
        SELECT
        <include refid="columnNames"/>
        FROM `TABLES`
        <include refid="where"/>
        <include refid="limit"/>
    </select>

	<!-- 动态查询单个  -->
    <select id="querySingle" resultType="com.icss.ccp.ios.bridge.domain.FullTable">
        SELECT
        <include refid="columnNames"/>
        FROM `TABLES`
        <include refid="where"/>
    </select>

    <!-- 新增  -->
    <insert id="insertFullTable" parameterType="com.icss.ccp.ios.bridge.domain.FullTable">
        INSERT INTO `TABLES`(<include refid="columnNames"/>)
        VALUES(#{tableCatalog}, #{tableSchema}, #{tableName}, #{tableType}, #{engine}, #{version}, #{rowFormat}, #{tableRows}, #{avgRowLength}, #{dataLength}, #{maxDataLength}, #{indexLength}, #{dataFree}, #{autoIncrement}, #{createTime}, #{updateTime}, #{checkTime}, #{tableCollation}, #{checksum}, #{createOptions}, #{tableComment})
    </insert>

    <!-- 根据 id 修改  -->
    <update id="updateFullTable">
        UPDATE `TABLES`
        SET
        <foreach collection="sqlUpdates" separator="," item="item">
            <bind name="_param1" value="item.sqlName" />
            <if test="item.isInclude">
                ${_param1} = #{item.value}
            </if>
        </foreach>
        <where>
            UUID = #{uuid}
        </where>
    </update>

    <!-- 根据 id 删除  -->
    <delete id="deleteFullTable" parameterType="long">
        DELETE FROM `TABLES`
        <where>
            UUID = #{uuid}
        </where>
    </delete>
</mapper>